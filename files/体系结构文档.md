# 软件体系结构文档

## 1 文档修改历史

| 修改人员 | 日期       | 修改原因                                                     | 版本号 |
| :------: | ---------- | ------------------------------------------------------------ | ------ |
|  郑悦辰  | 2020.04.19 | 撰写数据层分解部分                                           | V1.0   |
|   付涵   | 2020.04.21 | 撰写物理部署部分、绘制服务器端开发包图                       | V1.1   |
|  郭增嘉  | 2020.04.22 | 撰写运行进程部分、绘制客户端开发包图、撰写业务逻辑层分解、职责与接口规范 | V1.2   |
|  闫玮琦  | 2020.04.22 | 撰写引言、产品概述、逻辑视图部分                             | V1.3   |
|  郑悦辰  | 2020.04.24 | 绘制开发包图表                                               | V1.4   |
|  闫玮琦  | 2020.04.24 | 完善逻辑视图部分、填写信息视角内容                           | V1.5   |
|   付涵   | 2020.04.24 | 撰写用户界面层分解部分                                       | V1.6   |
|   郭增嘉   | 2020.04.24 | 修改会议列出错误并编号                                     | V1.7   |
| 郑悦辰 | 2020.06.20 | 补充完善 | V2.0 |


## 2 引言

### 2.1 编制目的

本报告详细完成对酒店管理系统的概要设计，达到指导详细设计和开发的目的，同时实现和测试人员及用户的沟通。
本报告面向开发人员、测试人员及最终用户而编写，是了解系统的导航。

### 2.2 词汇表

| 词汇名称 | 词汇含义 | 备注 |
| :------: | -------- | ---- |
| HMS | 酒店管理系统 | 无 |



### 2.3 参考资料

[1] IEEE标准.
[2] 骆斌主编. 软件工程与计算 ( 卷二 ): 软件开发的技术基础[M]. 北京: 机械工业出版社, 2012. 399-403.

## 3 产品概述

参考酒店管理系统用例文档和酒店管理系统软件需求规格说明中对产品的概括描述。

## 4 逻辑视角

酒店管理系统中，选择了分层体系结构风格，将系统分为3层（展示层、业务逻辑层、数据层）能够更好地示意整个高层抽象。展示层包含GUI页面的实现，业务逻辑层包含业务逻辑处理的实现，数据层负责数据的持久化和访问。分层体系结构的逻辑视角和逻辑设计方案如图1和图2所示。

- 图1 参照体系结构风格的包图表达逻辑视角

  ![图1 参照体系结构风格的包图表达逻辑视角](http://cloud.maplefzh.cn/index.php?user/publicLink&fid=d5119TkOLOPYariPLg52XcAyck8dsY-Dvu_YyMXv8PuAEjjqNsj6I09Avle6zJoTi9ZlBsxIAIWZl1mh25-otrFP9WmV0NnToTh-cvgq3Nl84_v4S3GUyqdDUQXKqguGT9tj-z10bk7qRaCwlHXCwWEeXi9iEiJj-r-dZqgItsVS1H7y1ANjHwC-2HvtAQQRoLZW40Cs&file_name=/%E9%80%BB%E8%BE%91%E8%A7%86%E8%A7%921.jpg)

- 图2 软件体系结构逻辑设计方案

  ![图2 软件体系结构逻辑设计方案](http://cloud.maplefzh.cn/index.php?user/publicLink&fid=6a86XccNlagDDOzeQjqyFAU9qCSxeDZqivf8SCEBOctpOI1FDn85IuXjqKtIRuMWT5cP44nFcJXkNoQLiAsIk2AzlYCvaYwOSjxq8T6OLrivrn85D_snyHnGqQ_65YDepivDF4Ywjd6CnVYxaGxfH4LpcjYmLSYO7Fxuqdi_ui6C_K7KzxpzNrxcqYvTLPBREIt-qeALxX2U3G7yJIugPgnnw-GgQv7pM2ZtZiU&file_name=/%E8%BD%AF%E4%BB%B6%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E9%80%BB%E8%BE%91%E8%AE%BE%E8%AE%A1%E6%96%B9%E6%A1%88.jpg)

## 5 组合视角

### 5.1 开发包图

酒店管理系统的最终开发包设计如表1所示。

- 表1 酒店管理系统的最终开发包设计

|       开发包       | 依赖的其他开发包                    |
| ----------------- | ----------------------------------- |
|       views.admin       | store.admin, router                 |
|       views.hotel       | store.hotel, router                |
|       views.hotelManager       | store.hotelManager, router          |
|       views.marketManager       | store.marketManager, router         |
|       views.user       | store.user, router                  |
|       store.admin       | api.admin, api.hotel |
|       store.hotel       | api.coupon, api.hotel, api.order |
|       store.hotelManager       | api.coupon, api.hotel, api.hotelManager, api.order |
|       store.marketManager       | api.coupon, api.order, api.user |
|       store.user       | api.order, api.user |
|       router       |                                     |
|        api.admin        | REST API                            |
|        api.coupon        | REST API                            |
|        api.hotel        | REST API                            |
|        api.hotelManager        | REST API                            |
|        api.order        | REST API                            |
|        api.user        | REST API                            |
|  controller.admin  | REST API, vo, bl.admin              |
| controller.coupon  | REST API, vo, bl.coupon             |
|  controller.hotel  | REST API, vo, bl.hotel              |
|  controller.order  | REST API, vo, bl.order              |
| controller.user | REST API, vo, bl.user         |
|      bl.admin      | vo, po                              |
|     bl.coupon      | vo, po                              |
|      bl.hotel      | vo, po                              |
|      bl.order      | vo, po                              |
|     bl.user     | vo, po                              |
|    blimpl.admin    | vo, po, enums, bl.admin, data.admin |
|   blimpl.coupon    | vo, po, enums, bl.coupon, data.coupon |
|    blimpl.hotel    | vo, po, enums, bl.hotel, data.hotel |
|    blimpl.order    | vo, po, enums, bl.hotel, bl.order, bl.user, data.order |
|   blimpl.user   | vo, po, enums, bl.user, data.user |
|     data.admin     | po                               |
|    data.coupon     | po                                  |
|     data.hotel     | vo, po                              |
|     data.order     | po                                  |
|    data.account    | po                                  |
|   dataimpl.admin   | data.admin                          |
|  dataimpl.coupon   | data.coupon                         |
|   dataimpl.hotel   | data.hotel                          |
|   dataimpl.order   | data.order                          |
|  dataimpl.account  | data.account                        |

酒店管理系统客户端开发包图如图3所示，服务器端开发包图如图4所示。

- 图3 酒店管理系统客户端开发包图

  ![图3 酒店管理系统客户端开发包图](http://cloud.maplefzh.cn/index.php?user/publicLink&fid=918dsFghzqdlu4XTSEJFqc1K4VJl9qGYoDY6D-r_VfIT6FQ7TEKReTOE30Rbofl2t_iJU9IP1_3PjK0Ep0x_83hLtdJWrIRp9wJ184-_3MspvDMiRBmhL7WohRs-fqYpY-oC3d8Co-Tpze_opaYBfo5M6CB5yfYFwIwuv_MsXIyHfpdqTpmnRZZb8Vh3sl7d76ywcwAmsCgLHieZUqE&file_name=/%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%BC%80%E5%8F%91%E5%8C%85%E5%9B%BE.jpg)

- 图4 酒店管理系统服务器端开发包图

  ![图4 酒店管理系统服务器端开发包图](http://cloud.maplefzh.cn/index.php?user/publicLink&fid=eb0emkuFQn2YNeL8AESM51e62Atf_PfG342NfoHDrxaPYwL3MPnnVS6Gjl-GyMctwBEgXKJ6KvhU4RYtPmpVVV_povnhrRf2TBOKqKDnPgS_ISiH_NuZApcQelggi0h6QR6Li0dked891W0YOHlkLaT6kT1mfNy1Bx7mKr7CSlRD5CdnT6mJPhTWHb87Qiq3o3OelzdasY5wsmh-gZT-jio&file_name=/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E5%BC%80%E5%8F%91%E5%8C%85%E5%9B%BE.jpg)

  


### 5.2 运行时进程

在酒店管理系统中，会有多个客户端进程和一个服务端进程，其进程图如图5所示。结合部署图，客户端进程是在浏览器上运行，服务端进程在服务端机器上运行。

- 图5 进程图
  ![图5 进程图](http://cloud.maplefzh.cn/index.php?user/publicLink&fid=66a9IhXTnMkgHvOwsYl-s5LRuSdm2GMOutg7a3I_qwmIxdSGxkz4MJU0AfwLG6occt7JVKKm6m6f71D7ZoXu0HUuH-dANPia3ddsEJ8mowiXquxZlF7z0YjbONKAfFDFqMi0SiAG8cUdbMatyeUnKhtb1QhUpFkUvi3xFw8dqt0KmzqcPsm3lk_pH0UXjWxO3dk&file_name=/%E8%BF%9B%E7%A8%8B%E5%9B%BE.jpg)

### 5.3 物理部署

酒店管理系统中客户端构件是在浏览器上运行，服务器端构件是在服务器端机器上运行。部署图如图6所示。

- 图6 部署图

![图6 部署图](http://cloud.maplefzh.cn/index.php?user/publicLink&fid=cb57yQc1CBmGE4V_nNx0DAoPHarkMDnP4AbVub0QT2MHsh5-zvT3YtYiGjD2UUVJfMer_Eoq-7TZOWsxtT3XJnGrktuGHauZiKBtPdbIATEGvmpWsEm0aLVnVscB_JHPFVUE90IQd1xPHxQT3mQ61wrWoj9MpmWI4PiiYMd_pZ2yDwnRHjR_AxkY-gSdG8wXk2E&file_name=/%E9%83%A8%E7%BD%B2%E5%9B%BE.jpg)

## 6 架构设计	

### 6.1 模块职责

客户端模块和服务器端模块视图分别如图7和图8所示。客户端各层和服务器端各层的职责分别如表2和表3所示。

- 图7 客户端模块视图

![图7 客户端模块视图](http://cloud.maplefzh.cn/index.php?user/publicLink&fid=2433bww0qZv0QQrYfQvu7Lm3TRWOZYJYBLwMF06xg2eU4J2wjp-xWdfypt4o6EYg2twCE9Xca_pkiY-sK34AOG85yY9oWUXaBhw-rkUZqAHVQ_aN5aycGpMnXjsRUzZdVdk9K89KZQVHGF7JocMg8GCHAKvPkphh_bbu3SfSIZVKRV4F7Gcn_Qm_XNVhYGPnmC0G1EiOEFJ4du-CKeM&file_name=/%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%A8%A1%E5%9D%97%E8%A7%86%E5%9B%BE.jpg)

- 图8 服务器端模块视图

  ![图8 服务器端模块视图](http://cloud.maplefzh.cn/index.php?user/publicLink&fid=e1ddg1kNN8CeA6oaVjHNBWJLxCpcSHdqQqZ-TpnMCXc-l7eQd63AmUdL55OotNPSzlGNTN_m6lsZIE3tRolNGpmMs1wuVymNPnL1rKmnqNWJcjonKemKSGVVJvZRDKeee8SfpNmzkriix3LuT4KvjXv2t9Fm9QutlI1tDLBZkLdfxaaHYQ-LsUyloVQqCK8ovtFY7hV3xyZf7VbK57Tz8ZM&file_name=/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E6%A8%A1%E5%9D%97%E8%A7%86%E5%9B%BE.jpg)

- 表2 客户端各层的职责

|层     | 职责     |
| -------- | -------- |
| 展示层 | 展示酒店管理系统客户端界面 |
| 客户端网络模块 | 向服务器端发送HTTP请求 |

- 表3 服务器端各层的职责

|层     | 职责     |
| -------- | -------- |
| 启动模块 | 负责初始化网络通信机制，启动服务器端 |
| 服务端网络模块 | 接收客户端的HTTP请求 |
| 业务逻辑层 | 客户端的请求进行相应并进行业务逻辑处理 |
| 数据层 | 负责数据持久化及数据访问接口 |

每一层只是使用下方直接接触的层。层与层之间仅仅是通过接口的调用来完成的。层之间调用的接口如表4所示。

- 表4 层之间调用接口

| 接口                                                         | 服务调用方         | 服务提供方         |
| ------------------------------------------------------------ | ------------------ | ------------------ |
| AdminService<br>CouponMatchStrategy<br>CouponService<br>HotelService<br>RoomService<br>OrderService<br>AccountService | 客户端展示层       | 服务器端业务逻辑层 |
| AdminMapper<br>CouponMapper<br>HotelMapper<br>RoomMapper<br>OrderMapper<br>AccountMapper | 服务器端业务逻辑层 | 服务器端数据层     |

### 6.2 用户界面层分解

根据需求，系统存在 41 个用户界面：登录界面、注册界面、客户主界面、酒店列表界面、搜索酒店界面、酒店详情界面、酒店评价界面、本店历史订单界面、房间信息界面、酒店预订界面、个人中心界面、我的信息界面、修改我的信息界面、我的订单界面、订单评价界面、历史评价界面、订单详情界面、酒店工作人员主界面、酒店管理界面、添加酒店界面、酒店优惠策略界面、添加酒店优惠界面、编辑酒店界面、客房管理界面、添加客房界面、订单管理界面、订单详情界面、网站管理人员主界面、查看会员界面、酒店管理界面、添加酒店管理员界面、更改酒店管理员界面、账户管理界面、修改用户信息界面、添加酒店工作人员界面、网站营销人员主界面、网站优惠策略界面、添加网站优惠界面、信用充值界面、等级充值界面、异常处理界面。界面跳转如图9所示。

- 图9 用户界面跳转

![图9 用户界面跳转](http://cloud.maplefzh.cn/index.php?user/publicLink&fid=4be1x8o86_iGr-XUCahNaY45w3ChtUzYFIiQCby9JE5Lkb4KBU0mQPcm7QwGJ0pdPo7gkylaVKe6T8uR8B4TOwzrDmKUPVyEWqJhysFnCVK0kff7I7xxPZr5mk1P5b8NhMfnMyubt5G7Q6EvsUkUjCGt0M7DPugxjDjBfVfN4V963bDresFSApAWfk0-PpoiibjjvvNyzuP-L4mLLXo&file_name=/%E7%94%A8%E6%88%B7%E7%95%8C%E9%9D%A2%E5%B1%82%E7%B1%BB%E5%9B%BE.jpg)

#### 6.2.1 用户界面层模块的职责

- 表5 用户界面层模块的职责

|模块     | 职责     |
| -------- | -------- |
| views | 负责客户端界面的视觉效果 |
| router | 负责客户端界面的路由和跳转 |
| store | 负责集中式存储管理界面的所有组件的状态 |
| api | 负责向服务器端发起HTTP请求 |

#### 6.2.2 用户界面层模块的接口规范

用户界面层模块的接口规范如表6所示

- 表6 用户界面层模块的接口规范

<table>
    <tr>
        <td rowspan="3">App.vue</td>
        <td>语法</td>
        <td>new Vue({ router, store, render })</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>无</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>显示登录界面</td>
    </tr>
</table>

用户界面层需要的服务接口如表7所示

- 表7 用户界面层模块所需要的服务接口

| 服务名       | 服务                                  |
| ------------ | ------------------------------------- |
| controller.* | 客户端的每个API服务器端都有相应的接口 |



### 6.3 业务逻辑层分解

业务逻辑层包括多个针对界面的业务逻辑处理对象。业务逻辑层的设计如图10所示。业务逻辑层模块的描述具体如图11~图15所示。

- 图10 业务逻辑层的设计

![图10 业务逻辑层的设计](http://cloud.maplefzh.cn/index.php?user/publicLink&fid=b54fNJiAdPCNozbOYc2QEIbdkWTDydznhoTzsSZZg6QkYkfE1YEXnGSiHwJgb_zqcS-CwaIu9AOyVTxF69HZgUTBMOwwlJdNpfAtVZ3tGOATRKYKvY_ZO4pqQXDDmslE2Nefe3QlTcqrI4slYIx4zuX23pB5yshTmXSCYFK-9TbSd5qj0cV1MmHWPMVo83S9DWubUZdUT25MWRP3vYFees8&file_name=/%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91%E5%B1%82%E7%9A%84%E8%AE%BE%E8%AE%A1.jpg)

- 图11 admin包业务逻辑层模块的描述

![图11 admin包业务逻辑层模块的描述](http://cloud.maplefzh.cn/index.php?user/publicLink&fid=d4e7m2ftIxQhJZXDRpcB1dKqFeuSYML63d26FTXVDWJ_PQRhl_-70vDTAVuuvwt1bzZLlHyKWE9sdC6Hmj93tUdyW5yQQmQza4MctlOtM6lsTkYzrRXavE0A83JxJVjPrSE7WwD16MY0MuN0oCrUS21bNvii2HhxjzJrIPhyedhlKoQeWXbv90Hj5dG5nbnG_Xc24bTkaLwOD5KMwFHNEPihTd7TgxHX1_oXZd8B-A&file_name=/Admin%E5%8C%85%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91%E5%B1%82%E6%A8%A1%E5%9D%97%E7%9A%84%E6%8F%8F%E8%BF%B0.jpg)

- 图12 coupon包业务逻辑层模块的描述

![图12 coupon包业务逻辑层模块的描述](http://cloud.maplefzh.cn/index.php?user/publicLink&fid=4624OWDQP3pJFJ903RpK3mYhOYhQMmECawX768VtXUJ5yLM3PDMIt-LhVbxhCp90aKyZHSRzsjTEJK8K8aPgSDpJa1TrLSHjk5XRvJuV9iIwQN_ERTjI-H5rrBx5lKqSSxHJA2Dmus3cPAllmSscCH2B4FryETz48BJozRcgVfBIzbTPQnerIdPOmhg0GWeynG_o9xYxcsdgewnGCfHrWXEWMmvERv2xQ4IXtwBxxPU&file_name=/Coupon%E5%8C%85%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91%E5%B1%82%E6%A8%A1%E5%9D%97%E7%9A%84%E6%8F%8F%E8%BF%B0.jpg)

- 图13 hotel包业务逻辑层模块的描述

![图13 hotel包业务逻辑层模块的描述](http://cloud.maplefzh.cn/index.php?user/publicLink&fid=dc01T05AAN9tyBLPWOay9y8TWtSvIFzfB7jEPQRsbFOxI20QhJaPU9c1SyFijcamWBv_ITGiltMeY4QDICV1MyesOphyBbRzXHhx1sjkrAxbDtt1AadWfaYCjAmbxANYj-HfMqFGei9W-q5tOseEZl82kvQ_oW81RC74P7X6sXjTyhE1x6XwfMNT_6OnS9y9lm4e4F0jE4598MIlJTo4X-GX2tzUB5VY321wdKj-2g&file_name=/Hotel%E5%8C%85%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91%E5%B1%82%E6%A8%A1%E5%9D%97%E7%9A%84%E6%8F%8F%E8%BF%B0.jpg)

- 图14 order包业务逻辑层模块的描述

![图14 order包业务逻辑层模块的描述](http://cloud.maplefzh.cn/index.php?user/publicLink&fid=a4e9NT5GZNFu4a-NBBWIfQsNbHf96tmpJuZhsS6tyLrDHTktJXkK6u7FEyv0a8mqCx8h3rp_lWB2GT0NrCpxA3WMEeg-OW9BqsaLco03qgV8WXgYenqIHbuDdjyGpSDT27Lblad1rYCpI0T6hzncVKUpDf8LhR452nyLwnGa7q881JBa9LzHy-avWhx4AkJD-anyk8JMsdna1wMR1rsvkz3vMLeAn-NQmdANmvRrDQ&file_name=/Order%E5%8C%85%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91%E5%B1%82%E6%A8%A1%E5%9D%97%E7%9A%84%E6%8F%8F%E8%BF%B0.jpg)

- 图15 user包业务逻辑层模块的描述

![图15 user包业务逻辑层模块的描述](http://cloud.maplefzh.cn/index.php?user/publicLink&fid=6e42__djy7qY9E1ySbWejiSlp0kbHgFjSFB61iO-q9tnjBx2PBJ8ZcHBax3zBzz-SFiFwPrlXc3Vym1C-Iuzx968IRbl2hBLsGK-7-Qr5w7Mn-e06W78Ua9Io5e3gJ-HF7INgY3NIR607GZlRk1KO0u187P8zlGLnbmV_IuT11gSSZ1-zPNYrPGRQUqmursesVa01_VTAefQYfnDD7HPRPGQd3_uVWSBo3xh8LZ0&file_name=/User%E5%8C%85%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91%E5%B1%82%E6%A8%A1%E5%9D%97%E7%9A%84%E6%8F%8F%E8%BF%B0.jpg)

#### 6.3.1 业务逻辑层模块的职责

业务逻辑层模块的职责如表8~表12所示。

- 表8 admin包业务逻辑层模块的职责

|模块     | 职责     |
| -------- | -------- |
| AdminService | 负责实现网站管理人员所需要的对用户管理的服务 |

- 表9 coupon包业务逻辑层模块的职责

|模块     | 职责     |
| -------- | -------- |
| CouponService | 负责实现各种优惠操作所需要的服务 |
| CouponMatchStrategy | 负责实现各种优惠匹配所需要的服务 |

- 表10 hotel包业务逻辑层模块的职责

|模块     | 职责     |
| -------- | -------- |
| HotelService | 负责实现与酒店操作相关所需要的服务 |
| RoomService | 负责实现与酒店房间操作相关所需要的服务 |

- 表11 order包业务逻辑层模块的职责

|模块     | 职责     |
| -------- | -------- |
| OrderService | 负责实现与订单操作相关所需要的服务 |

- 表12 user包业务逻辑层模块的职责

|模块     | 职责     |
| -------- | -------- |
| AccountService | 负责实现与用户登录注册、信息修改所需要的服务 |

#### 6.3.2 业务逻辑层模块的接口规范

业务逻辑层模块的职责如表13~表17所示。

- 表13 admin包模块的接口规范

<table>
    <tr>
        <th colspan="3" align="center">提供的服务（供接口）</td>
    </tr>
    <tr>
        <td rowspan="3">AdminService.addManager</td>
        <td>语法</td>
        <td>ResponseVO addManager(UserForm userForm);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>同样userForm不存在</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>增加一个酒店管理员</td>
    </tr>
    <tr>
        <td rowspan="3">AdminService.editUserInfo</td>
        <td>语法</td>
        <td>ResponseVO editUserInfo(UserForm userForm, int userid);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>存在该userid的用户</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>修改该userid用户的个人信息</td>
    </tr>
    <tr>
        <td rowspan="3">AdminService.deleteUser</td>
        <td>语法</td>
        <td>ResponseVO deleteUser(int userid);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>存在该userid的用户</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>删除掉该userid的用户</td>
    </tr>
    <tr>
        <td rowspan="3">AdminService.getAllManagers</td>
        <td>语法</td>
        <td>List&lt;User&gt; getAllManagers();</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>无</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回一个包含所有用户类型为HotelManager的User的列表</td>
    </tr>
    <tr>
        <td rowspan="3">AdminService.getAllUsers</td>
        <td>语法</td>
        <td>List&lt;User&gt; getAllUsers();</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>无</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回一个包含所有User的列表</td>
    </tr>
    <tr>
        <td rowspan="3">AdminService.getVip</td>
        <td>语法</td>
        <td>List&lt;User&gt; getVip();</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>无</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回一个包含所有是VIP的User的列表</td>
    </tr>
</table>
<table>
    <tr>
        <th colspan="3" align="center">需要的服务（需接口）</td>
    </tr>
    <tr>
        <td align="center">服务名</td>
        <td  align="center">服务</td>
    </tr>
    <tr>
        <td>AdminMapper.addManager(User user)</td>
        <td >在数据库中增加一个酒店管理员</td>
    </tr>
    <tr>
        <td>AdminMapper.editUserInfo(int id, String address, String username, String phonenumber)</td>
        <td >更新数据库中该用户信息</td>
    </tr>
    <tr>
        <td>AdminMapper.getAllManagers</td>
        <td >得到User数据库中所有酒店管理员的列表</td>
    </tr>
    <tr>
        <td>AdminMapper.getAllUsers</td>
        <td >得到User数据库中所有用户的列表</td>
    </tr>
    <tr>
        <td>AdminMapper.getVip</td>
        <td >得到User数据库中所有会员的列表</td>
    </tr>
    <tr>
        <td>AdminMapper.deleteUser(int userid)</td>
        <td >删除一个用户条目</td>
    </tr>
</table>

- 表14 coupon包模块的接口规范

<table>
    <tr>
        <th colspan="3" align="center">提供的服务（供接口）</td>
    </tr>
    <tr>
        <td rowspan="3">CouponService.getMatchOrderCoupon</td>
        <td>语法</td>
        <td>List&lt;Coupon&gt; getMatchOrderCoupon(OrderVO orderVO);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>无</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回某一订单可用的优惠策略列表</td>
    </tr>
    <tr>
        <td rowspan="3">CouponService.getHotelAllCoupon</td>
        <td>语法</td>
        <td>List&lt;Coupon&gt; getHotelAllCoupon(Integer hotelId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>存在同样ID的hotel</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回某个酒店提供的所有优惠策略（包括失效的）列表</td>
    </tr>
    <tr>
        <td rowspan="3">CouponService.getAllAvailableCoupon</td>
        <td>语法</td>
        <td>List&lt;Coupon&gt; getlAllAvailableCoupon(Integer hotelId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>存在同样ID的hotel</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回某个酒店所有可用的优惠策略列表</td>
    </tr>
	<tr>
        <td rowspan="3">CouponService.addHotelTargetMoneyCoupon</td>
        <td>语法</td>
        <td>CouponVO addHotelTargetMoneyCoupon(HotelTargetMoneyCouponVO couponVO);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>系统中不存在同样的优惠策略</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>在系统中添加一个酒店满减优惠策略</td>
    </tr>
    <tr>
        <td rowspan="3">CouponService.addTimeCoupon</td>
        <td>语法</td>
        <td>CouponVO addTimeCoupon(TimeCouponVO couponVO);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>系统中不存在同样的优惠策略</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>在系统中添加一个限时优惠策略</td>
    </tr>
    <tr>
        <td rowspan="3">CouponService.addMemberCoupon</td>
        <td>语法</td>
        <td>CouponVO addMemberCoupon(MemberCouponVO couponVO);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>系统中不存在同样的优惠策略</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>在系统中添加一个会员优惠策略</td>
    </tr>
    <tr>
        <td rowspan="3">CouponService.addManyHousesCoupon</td>
        <td>语法</td>
        <td>CouponVO addManyHousesCoupon(ManyHousesCouponVO couponVO);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>系统中不存在同样的优惠策略</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>在系统中添加一个多间优惠策略</td>
    </tr>
	<tr>
        <td rowspan="3">CouponMatchStrategy.isMatch</td>
        <td>语法</td>
        <td>boolean isMatch(OrderVO orderVO, Coupon coupon);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>系统中存在该订单与该优惠</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回订单是否与优惠策略匹配的结果</td>
    </tr>
</table>
<table>
    <tr>
        <th colspan="2" align="center">需要的服务（需接口）</td>
    </tr>
    <tr>
        <td align="center">服务名</td>
        <td align="center">服务</td>
    </tr>
    <tr>
        <td>CouponMapper.selectedByHotelId(Integer hotelId)</td>
        <td>根据id进行查找获得酒店所有优惠策略</td>
    </tr>
    <tr>
        <td>CouponMapper.selectedAvailableCoupon(Integer hotelId)</td>
        <td >根据id进行查找获得酒店所有可用的优惠策略</td>
    </tr>
    <tr>
        <td>CouponMapper.insertCoupon(Coupon coupon)</td>
        <td >在数据库Coupon表中插入coupon对象</td>
    </tr>
    <tr>
        <td>CouponMapper.getCouponList</td>
        <td >获得所有优惠策略</td>
    </tr>
    <tr>
        <td>CouponMapper.deleteCoupon(int couponid)</td>
        <td >根据id进行删除一个coupon条目</td>
    </tr>
</table>

- 表15 hotel包模块的接口规范

<table>
    <tr>
        <th colspan="3" align="center">提供的服务（供接口）</td>
    </tr>
    <tr>
        <td rowspan="3">HotelService.addHotel</td>
        <td>语法</td>
        <td>void addHotel(HotelVO hotelVO);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>同样的hotel在系统中不存在</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>在系统中增加一个hotel</td>
    </tr>
    <tr>
        <td rowspan="3">HotelService.updateRoomInfo</td>
        <td>语法</td>
        <td>void updateRoomInfo(Integer hotelId, String roomType,Integer rooms);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>预订结束</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>在系统中修改剩余客房信息</td>
    </tr>
	<tr>
        <td rowspan="3">HotelService.retrieveHotels</td>
        <td>语法</td>
        <td>List&lt;HotelVO&gt; retrieveHotels();</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>无</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回所有酒店的列表</td>
    </tr>
    <tr>
        <td rowspan="3">HotelService.retrieveManagerHotels</td>
        <td>语法</td>
        <td>List&lt;HotelVO&gt; retrieveManagerHotels(Integer managerId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>无</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回ID为managerId的酒店管理员所管理的酒店的列表</td>
    </tr>
    <tr>
        <td rowspan="3">HotelService.retrieveSearchedHotels</td>
        <td>语法</td>
        <td>List&lt;HotelVO&gt; retrieveSearchedHotels(String region, String address, String name, String star, Integer rate0, Integer rate1);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>无</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回所有符合搜索条件的酒店的列表</td>
    </tr>
	<tr>
        <td rowspan="3">HotelService.retrieveHotelDetails</td>
        <td>语法</td>
        <td>HotelVO retrieveHotelDetails(Integer hotelId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在系统中存在同样ID的hotel</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>按ID进行查找返回相应的HotelVO结果</td>
    </tr>
    <tr>
        <td rowspan="3">HotelService.getRoomCurNum</td>
        <td>语法</td>
        <td>int getRoomCurNum(Integer hotelId,String roomType);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在系统中存在同样ID的hotel</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回该房间类型的房间总数</td>
    </tr>
    <tr>
        <td rowspan="3">HotelService.editHotel</td>
        <td>语法</td>
        <td>void editHotel(HotelVO hotelVO);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>存在该酒店</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>酒店更新其详细信息</td>
    </tr>
    <tr>
        <td rowspan="3">HotelService.updateHotelImg</td>
        <td>语法</td>
        <td>ResponseVO updateHotelImg(MultipartFile file, Integer hotelId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>存在同样hotelid的酒店</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>更新酒店照片</td>
    </tr>
    <tr>
        <td rowspan="3">HotelService.getHotelImg</td>
        <td>语法</td>
        <td>String getHotelImg(Integer hotelId)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>存在同样hotelid的酒店</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回该酒店图片的Base64字符串</td>
    </tr>
    <tr>
        <td rowspan="3">HotelService.updateTotalMoney</td>
        <td>语法</td>
        <td>void updateTotalMoney(Integer hotelId, Double money);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>存在同样hotelid的酒店</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>计算酒店的总营业额</td>
    </tr>
    <tr>
        <td rowspan="3">HotelService.updateRate</td>
        <td>语法</td>
        <td>void updateRate(Integer hotelId, Integer count, Integer newRate);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>存在同样hotelid的酒店</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>更新酒店的评分</td>
    </tr>
	<tr>
        <td rowspan="3">RoomService.retrieveHotelRoomInfo</td>
        <td>语法</td>
        <td>List&lt;HotelRoom&gt; retrieveHotelRoomInfo(Integer hotelId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在系统中存在同样ID的hotel</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回这个id对应酒店的所有房间信息的列表</td>
    </tr>
	<tr>
        <td rowspan="3">RoomService.insertRoomInfo</td>
        <td>语法</td>
        <td>void insertRoomInfo(HotelRoom hotelRoom);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>无</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>在系统中增加一个酒店客房及其信息</td>
    </tr>
	<tr>
        <td rowspan="3">RoomService.updateRoomInfo</td>
        <td>语法</td>
        <td>void updateRoomInfo(Integer hotelId, String roomType, Integer rooms);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在系统中存在同样ID的hotel且预订结束</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>在系统中更新客房房间数量</td>
    </tr>
	<tr>
        <td rowspan="3">RoomService.getRoomCurNum</td>
        <td>语法</td>
        <td>int getRoomCurNum(Integer hotelId, String roomType);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在系统中存在同样ID和roomType的hotel</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>按ID和roomType进行查找返回相应的数值</td>
    </tr>
    <tr>
        <td rowspan="3">RoomService.editRoomPrice</td>
        <td>语法</td>
        <td>int editRoomPrice(Integer roomId, Integer val);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>存在同样roomid的房间</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>修改此房间的价格</td>
    </tr>
    <tr>
        <td rowspan="3">RoomService.editRoomTotal</td>
        <td>语法</td>
        <td>int editRoomTotal(Integer roomId, Integer val);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>存在同样roomid的房间</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>修改此房间的总数量</td>
    </tr>
    <tr>
        <td rowspan="3">RoomService.editRoomCurNum</td>
        <td>语法</td>
        <td>int editRoomCurNum(Integer roomId, Integer val);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>存在同样roomid的房间</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>修改此房间的现有剩余数量</td>
    </tr>
    <tr>
        <td rowspan="3">RoomService.deleteRoom</td>
        <td>语法</td>
        <td>int deleteRoom(Integer roomId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>存在同样roomid的房间</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>删除此种房间</td>
    </tr>
    <tr>
        <td rowspan="3">RoomService.getMinPrice</td>
        <td>语法</td>
        <td>int getMinPrice(Integer hotelId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>存在同样hotelId的酒店</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回该酒店所有房间的最低价格</td>
    </tr>
</table>
<table>
    <tr>
        <th colspan="3" align="center">需要的服务（需接口）</td>
    </tr>
    <tr>
        <td align="center">服务名</td>
        <td  align="center">服务</td>
    </tr>
    <tr>
        <td>HotelMapper.insertHotel(Hotel hotel)</td>
        <td >在数据库Hotel表中插入Hotel对象</td>
    </tr>
    <tr>
        <td>HotelMapper.deleteHotel(Integer hotelId)</td>
        <td >根据ID删除一个hotel条目</td>
    </tr>
    <tr>
        <td>HotelMapper.selectAllHotel</td>
        <td >获得所有酒店的列表</td>
    </tr>
    <tr>
        <td>HotelMapper.selectManagerHotels(Integer managerId)</td>
        <td >根据managerId进行查找多个hotel</td>
    </tr>
    <tr>
        <td>HotelMapper.selectSearchedHotel(String region, String address, String name, String star, Integer rate0, Integer rate1)</td>
        <td >根据多个字段进行查找符合要求的hotel</td>
    </tr>
    <tr>
        <td>HotelMapper.selectById(Integer hotelId)</td>
        <td >根据ID进行查找单一Hotel</td>
    </tr>
    <tr>
        <td>HotelMapper.setHotelManager(Integer hotelId, int mangerId)</td>
        <td >根据hotelId选择单一hotel并进行更新managerid字段</td>
    </tr>
    <tr>
        <td>HotelMapper.editHotel(Integer id, String name, String address, String hotelStar, String description, String phoneNum)</td>
        <td >根据hotelId选择单一hotel并进行更新多个字段</td>
    </tr>
    <tr>
        <td>HotelMapper.updateTotalMoney(Integer hotelId, double money)</td>
        <td >根据hotelId选择单一hotel并进行更新totalmoney字段</td>
    </tr>
    <tr>
        <td>HotelMapper.getCur_rate(Integer hotelId)</td>
        <td >根据hotelId选择单一hotel并获得rate字段</td>
    </tr>
    <tr>
        <td>HotelMapper.updateRate(Integer hotelId, double tar_rate)</td>
        <td >根据hotelId选择单一hotel并进行更新rate字段</td>
    </tr>
    <tr>
        <td>RoomMapper.updateRoomInfo(Integer hotelId, String roomType, Integer curNum)</td>
        <td >根据hotelid和roomtype选择单一room并更新curNum字段</td>
    </tr>
    <tr>
        <td>RoomMapper.insertRoom(HotelRoom hotelRoom)</td>
        <td >在数据库Room表中插入HotelRoom对象</td>
    </tr>
    <tr>
        <td>RoomMapper.selectRoomsByHotelId(Integer hotelId)</td>
        <td >根据hotelId选择查找多个HotelRoom</td>
    </tr>
    <tr>
        <td>RoomMapper.getRoomCurNum(Integer hotelId, String roomType)</td>
        <td >根据hotelid和roomtype选择单一room并获得curNum字段</td>
    </tr>
    <tr>
        <td>RoomMapper.getMinPrice(Integer hotelId)</td>
        <td >根据hotelid选择多个Room并获得price的最小值</td>
    </tr>
    <tr>
        <td>RoomMapper.editRoomPrice(Integer roomId, Integer val)</td>
        <td >根据roomId选择单一room并更新其price字段</td>
    </tr>
    <tr>
        <td>RoomMapper.editRoomTotal(Integer roomId, Integer val)</td>
        <td >根据roomId选择单一room并更新其total字段</td>
    </tr>
    <tr>
        <td>RoomMapper.editRoomCurNum(Integer roomId, Integer val)</td>
        <td >根据roomId选择单一room并更新其cur_num字段</td>
    </tr>
    <tr>
        <td>RoomMapper.deleteRoom(Integer roomId)</td>
        <td >删除Room表中的一条记录</td>
    </tr>
</table>

- 表16 order包模块的接口规范

<table>
    <caption>表16 order包业务逻辑层模块的接口规范</caption>
    <tr>
        <th colspan="3" align="center">提供的服务（供接口）</td>
    </tr>
    <tr>
        <td rowspan="3">OrderService.addOrder</td>
        <td>语法</td>
        <td> ResponseVO addOrder(OrderVO orderVO);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>同样的order在系统中不存在</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>在系统中增加一个order记录</td>
    </tr>
    <tr>
        <td rowspan="3">OrderService.setOrderExcep</td>
        <td>语法</td>
        <td> ResponseVO setOrderExcep(int orderid);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>存在同样orderid的订单</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>将此订单置为异常</td>
    </tr>
    <tr>
        <td rowspan="3">OrderService.recoverOrder</td>
        <td>语法</td>
        <td> ResponseVO recoverOrder(int orderid);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>存在同样orderid的订单且是异常订单</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>将此订单恢复正常</td>
    </tr>
    <tr>
        <td rowspan="3">CouponService.getAllOrders</td>
        <td>语法</td>
        <td>List&lt;Order&gt; getAllOrders();</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>无</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回一个包含所有order的列表</td>
    </tr>
    <tr>
        <td rowspan="3">CouponService.getManagerOrders</td>
        <td>语法</td>
        <td>List&lt;Order&gt; getManagerOrders(Integer managerid);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>无</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回一个该酒店管理员所管理的酒店的所有order的列表</td>
    </tr>
	<tr>
        <td rowspan="3">CouponService.getUserOrders</td>
        <td>语法</td>
        <td>List&lt;Order&gt; getUserOrders(int userid);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在系统中存在同样ID的user</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回该用户的所有订单的列表</td>
    </tr>
    <tr>
        <td rowspan="3">CouponService.getUserHotelOrders</td>
        <td>语法</td>
        <td>List&lt;Order&gt; getUserHotelOrders(int userid, int hotelid);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在系统中存在同样ID的user和同样id的酒店</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回该用户在此酒店的所有订单的列表</td>
    </tr>
    <tr>
        <td rowspan="3">CouponService.getHotelOrders</td>
        <td>语法</td>
        <td>List&lt;Order&gt; getHotelOrders(int hotelid);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在系统中存在同样id的酒店</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回此酒店的所有订单的列表</td>
    </tr>
    <tr>
        <td rowspan="3">OrderService.execOrder</td>
        <td>语法</td>
        <td>ResponseVO execOrder (int orderid);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在数据库中存在同样id的order</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>将该订单的已预定状态置为已入住</td>
    </tr>
    <tr>
        <td rowspan="3">OrderService.checkOut</td>
        <td>语法</td>
        <td>ResponseVO checkOut(OrderVO orderVO);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在数据库中存在同样id的order</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>将该订单的已入住状态置为已退房</td>
    </tr>
    <tr>
        <td rowspan="3">OrderService.annulOrder</td>
        <td>语法</td>
        <td>ResponseVO annulOrder(int orderid);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在数据库中存在同样id的order</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>更新一个order的状态为取消并扣除相应的信用</td>
    </tr>
    <tr>
        <td rowspan="3">OrderService.deleteOrder</td>
        <td>语法</td>
        <td>ResponseVO deleteOrder(OrderVO orderVO);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在数据库中存在同样id的order</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>由营销人员更新一个order的状态为异常</td>
    </tr>
    <tr>
        <td rowspan="3">OrderService.updateOrderComment</td>
        <td>语法</td>
        <td>ResponseVO updateOrderComment(OrderVO orderVO);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在数据库中存在同样id的order</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>增加该订单的评价信息，并对酒店评分进行更新</td>
    </tr>
    <tr>
        <td rowspan="3">OrderService.getComments</td>
        <td>语法</td>
        <td>List&lt;CommentVO&gt; getComments(Integer hotelId</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在数据库中存在同样id的酒店r</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回一个该酒店所有的评价信息的列表</td>
    </tr>
</table>
<table>
    <tr>
        <th colspan="3" align="center">需要的服务（需接口）</td>
    </tr>
    <tr>
        <td align="center">服务名</td>
        <td  align="center">服务</td>
    </tr>
    <tr>
        <td>OrderMapper.addOrder(Order order)</td>
        <td >在数据库的Order表中插入Order对象</td>
    </tr>
    <tr>
        <td>OrderMapper.getAllOrders</td>
        <td >获得Order表中所有Order对象</td>
    </tr>
    <tr>
        <td>OrderMapper.getUserOrders(int userid)</td>
        <td >根据userid选择并获得多个Order</td>
    </tr>
    <tr>
        <td>OrderMapper.getHotelOrders(int hotelId)</td>
        <td >根据hotelid选择并获得多个Order</td>
    </tr>
    <tr>
        <td>OrderMapper.getUserHotelOrders(int userid, int hotelId)</td>
        <td >根据userid和hotelid选择并获得多个Order</td>
    </tr>
    <tr>
        <td>OrderMapper.annulOrder(int orderid)</td>
        <td >根据orderid选择单一Order并更新orderState字段为“已撤销”</td>
    </tr>
    <tr>
        <td>OrderMapper.execOrder(int orderid)</td>
        <td >根据orderid选择单一Order并更新orderState字段为“已入住”</td>
    </tr>
    <tr>
        <td>OrderMapper.setOrderExcep(int orderid)</td>
        <td >根据orderid选择单一Order并更新orderState字段为“异常”</td>
    </tr>
    <tr>
        <td>OrderMapper.checkOut(int orderid)</td>
        <td >根据orderid选择单一Order并更新orderState字段为“已退房”</td>
    </tr>
    <tr>
        <td>OrderMapper.getOrderById(int orderid)</td>
        <td >根据orderid选择并获得单一Order对象</td>
    </tr>
    <tr>
        <td>OrderMapper.annualSubCredit(int orderid, double credit)</td>
        <td >根据orderid获得userid并更新其credit</td>
    </tr>
    <tr>
        <td>OrderMapper.updateOrderComment(int orderid, int star, String comment)</td>
        <td >根据orderid选择单一Order并更新star和comment字段</td>
    </tr>
    <tr>
        <td>OrderMapper.getCommentNum(int hotelId)</td>
        <td >根据hotelId选择多个Order获得其数目</td>
    </tr>
</table>

- 表17 user包模块的接口规范

<table>
    <tr>
        <th colspan="3" align="center">提供的服务（供接口）</td>
    </tr>
    <tr>
        <td rowspan="3">AccountService.registerAccount</td>
        <td>语法</td>
        <td>ResponseVO registerAccount(UserVO userVO)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>同样ID的user在系统中不存在</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>在系统中增加一个user记录</td>
    </tr>
    <tr>
        <td rowspan="3">AccountService.login</td>
        <td>语法</td>
        <td>User login(UserForm userForm);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>无</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回相应的User结果</td>
    </tr>
	<tr>
        <td rowspan="3">AccountService.getUserInfo</td>
        <td>语法</td>
        <td>User getUserInfo(int id);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>无</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>按ID进行查找返回对应的User结果</td>
    </tr>
	<tr>
        <td rowspan="3">AccountService.updateUserInfo</td>
        <td>语法</td>
        <td>ResponseVO updateUserInfo(int id, String password,String username,String phonenumber);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在系统中存在同样ID的user</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>更新一个user的个人信息</td>
    </tr>
    <tr>
        <td rowspan="3">AccountService.updateUserImg</td>
        <td>语法</td>
        <td>ResponseVO updateUserImg(MultipartFile file, Integer userId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在系统中存在同样ID的user</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>更新该用户的头像</td>
    </tr>
    <tr>
        <td rowspan="3">AccountService.getUserImg</td>
        <td>语法</td>
        <td>String getUserImg(Integer userId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在系统中存在同样ID的user</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回该用户头像的Base64编码</td>
    </tr>
    <tr>
        <td rowspan="3">AccountService.creditSet</td>
        <td>语法</td>
        <td>ResponseVO creditSet(UserVO userVO);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在系统中存在同样ID的user</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>更新该用户信用</td>
    </tr>
    <tr>
        <td rowspan="3">AccountService.lvSet</td>
        <td>语法</td>
        <td>ResponseVO lv(UserVO userVO);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在系统中存在同样ID的user</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>更新该用户总消费额和会员等级信息</td>
    </tr>
    <tr>
        <td rowspan="3">AccountService.getAccountByEmail</td>
        <td>语法</td>
        <td>User getAccountByEmail(String email);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在系统中存在同样email的user</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回该用户的个人信息</td>
    </tr>
    <tr>
        <td rowspan="3">AccountService.updateVip</td>
        <td>语法</td>
        <td>void updateVip(Integer userId, Double money);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在系统中存在同样ID的user</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>更新该用户总消费额和会员等级信息</td>
    </tr>
</table>
<table>
    <tr>
        <th colspan="3" align="center">需要的服务（需接口）</td>
    </tr>
    <tr>
        <td align="center">服务名</td>
        <td  align="center">服务</td>
    </tr>
    <tr>
        <td>AccountMapper.createNewAccount(User user)</td>
        <td >在数据库User表中插入User对象</td>
    </tr>
    <tr>
        <td>AccountMapper.getAccountByEmail(String email)</td>
        <td >根据Email进行查找获得单一User</td>
    </tr>
    <tr>
        <td>AccountMapper.getAccountById(int id)</td>
        <td >根据id进行查找获得单一User</td>
    </tr>
    <tr>
        <td>AccountMapper.updateAccount(int id, String password, String username, String phonenumber, String avatarurl)</td>
        <td >根据id进行查找单一User并更新多个字段</td>
    </tr>
    <tr>
        <td>AccountMapper.setCredit(int id, double credit)</td>
        <td >根据id进行查找单一User并更新credit字段</td>
    </tr>
    <tr>
        <td>AccountMapper.setLv(int id, double lv)</td>
        <td >根据id进行查找单一User并更新lv字段</td>
    </tr>
    <tr>
        <td>AccountMapper.setTotalMoney(int id, double totalmoney)</td>
        <td >根据id进行查找单一User并更新totalmoney字段</td>
    </tr>
</table>


### 6.4 数据层分解

数据层主要给业务逻辑层提供数据访问服务，包括对于持久化数据的增、删、改、查。数据层模块的描述具体如图16~图20所示。

- 图16 admin包数据层模块的描述

![图16 admin包数据层模块的描述](http://cloud.maplefzh.cn/index.php?user/publicLink&fid=c09d2Jrja_fGYQ8KOEuYKK2yCicx_EAoXCw2KuCT3vMKHTyfsHGHbqV2r3cWHtbsSIdD48GzYV3QwSisBKMFtfaFRk8Ec3nhOeIjI8lLSCtf6_Xj3h4ftzZABzjZcs1su5cnsQUoiuSpl6ApaydBSunW616vmQCFFrQ9UR1YU-3m9cNpJyhjY0ylG6lP7oJoeDIeocL8XuzSJIy9Opy4nXlS-yMzJdr8Jg&file_name=/Admin%E5%8C%85%E6%95%B0%E6%8D%AE%E5%B1%82%E6%A8%A1%E5%9D%97%E7%9A%84%E6%8F%8F%E8%BF%B0.jpg)

- 图17 coupon包数据层模块的描述

![图17 coupon包数据层模块的描述](http://cloud.maplefzh.cn/index.php?user/publicLink&fid=890baKJ864cKTAm6VmegAE1PE2znJMq-4Kb_MJe_EGLltuLOfwJUl-uFVzUl8EM3X-chxtOjKMe_0OGdy1x49xWRTy_veeb9kWxEKzUs9LOq-e_wbii5Qsxq-qtw6jr6EOO5P_ZsBXTRg6GipQcePRwc4Kd1PTJQMJpS7QMhjrNICDGfTbSfcy8GNdyYTuiARi5Tzu8rTU6clwgA_P0BeeYSaBKtOsk0uik&file_name=/Coupon%E5%8C%85%E6%95%B0%E6%8D%AE%E5%B1%82%E6%A8%A1%E5%9D%97%E7%9A%84%E6%8F%8F%E8%BF%B0.jpg)

- 图18 hotel包数据层模块的描述

![图18 hotel包数据层模块的描述](http://cloud.maplefzh.cn/index.php?user/publicLink&fid=60f5dAUi7ewn3eWsB_4hvqWcZtHvKP3hh6ymd-Sh7HdjO97pgU9_-9KJa7bSHdkBNxaZLWE3LCZtpLQOtBbejU4jBkPwsUFsbrDR4e51fIeW0qHIQBrF9z_2O9b49-xYgOCMxxairIKZAJnbmlli8nUpseSzC-khOMdjZTfmNuGWuyrDub5fVKgYud-Tezov6eOFVAeSN8eHL6rfS0dfwjMRk27i1i-YnQ&file_name=/Hotel%E5%8C%85%E6%95%B0%E6%8D%AE%E5%B1%82%E6%A8%A1%E5%9D%97%E7%9A%84%E6%8F%8F%E8%BF%B0.jpg)

- 图19 order包数据层模块的描述

![图19 order包数据层模块的描述](http://cloud.maplefzh.cn/index.php?user/publicLink&fid=3b89EX_hZmhOV8Wt1Vz5781-Qpj3oGPDhk_z2kAAs7R4bRpt7HWe77JBwwLFTuTC3fLQwRrDWNLY9YJsEzjXnSaCbeTlCByDiBjOjwNTeEGBsI2JcW_jhxWJaw0nnYRhwnNglfitSp9-FV8JaVrMO0_McQMDs5FwKiB-epk_W57X5mE4GT3ES0LJWUWPphguLtwCpCtnLGXDmRLhfxltKnLvFbcyX_5xrg&file_name=/Order%E5%8C%85%E6%95%B0%E6%8D%AE%E5%B1%82%E6%A8%A1%E5%9D%97%E7%9A%84%E6%8F%8F%E8%BF%B0.jpg)

- 图20 user包数据层模块的描述

![图20 user包数据层模块的描述](http://cloud.maplefzh.cn/index.php?user/publicLink&fid=b9eexA2ugxxaBubGzxFAAnWZSwCViihSyCugKlSxz9QJTY-X7-xC_n69EE7YZdu6IQuzK3jM2TrUq5PMfOrhBBd-SqIwsHZo7HeRg2O7xUROcdZMYjEKlG45BWhkzhNHFWIAEfUQqRJgqIvH8sf3dCp9jJ49vnYLmUIQLDzkVN7hEDDrFdZs9IZ8tJAYuWdIsKTYJHFxq549neAZT4zTSUWG-e5SxKGF&file_name=/User%E5%8C%85%E6%95%B0%E6%8D%AE%E5%B1%82%E6%A8%A1%E5%9D%97%E7%9A%84%E6%8F%8F%E8%BF%B0.jpg)

#### 6.4.1 数据层模块的职责

数据层模块的职责如表18~表22所示。

- 表18 admin包数据层模块的职责

| 模块          | 职责                                                 |
| ------------- | ---------------------------------------------------- |
| AdminMapper   | 持久化数据库的接口，提供集体载入、增、删、改、查服务 |

- 表19 coupon包数据层模块的职责

| 模块          | 职责                                                 |
| ------------- | ---------------------------------------------------- |
| CouponMapper  | 持久化数据库的接口，提供集体载入、增、删、查服务     |

- 表20 hotel包数据层模块的职责

| 模块          | 职责                                                 |
| ------------- | ---------------------------------------------------- |
| HotelMapper   | 持久化数据库的接口，提供集体载入、增、删、改、查服务 |
| RoomMapper    | 持久化数据库的接口，提供集体载入、增、删、改、查服务 |

- 表21 order包数据层模块的职责

| 模块          | 职责                                                 |
| ------------- | ---------------------------------------------------- |
| OrderMapper   | 持久化数据库的接口，提供集体载入、增、改、查服务     |

- 表22 user包数据层模块的职责

| 模块          | 职责                                                 |
| ------------- | ---------------------------------------------------- |
| AccountMapper | 持久化数据库的接口，提供增、改、查服务               |

#### 6.4.2 接口规范

数据层模块的接口规范如表23~表27所示。

- 表23 admin包数据层模块的接口规范

<table>
    <tr>
        <th colspan="3" align="center">提供的服务（供接口）</td>
    </tr>
    <tr>
        <td rowspan="3">AdminMapper.addManager</td>
        <td>语法</td>
        <td>int addManager(User user);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>同样ID的user在数据库中不存在</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>在数据库中增加一个user记录</td>
    </tr>
    <tr>
        <td rowspan="3">AdminMapper.editUserInfo</td>
        <td>语法</td>
        <td>int editUserInfo(int id, String address, String username, String phonenumber);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>同样ID的user在数据库中存在</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>更新一个User</td>
    </tr>
    <tr>
        <td rowspan="3">AdminMapper.getAllManagers</td>
        <td>语法</td>
        <td>List&lt;User&gt; getAllManagers();</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>无</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回一个包含所有usertype为hotelManager的User的列表</td>
    </tr>
    <tr>
        <td rowspan="3">AdminMapper.getAllUsers</td>
        <td>语法</td>
        <td>List&lt;User&gt; getAllUsers();</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>无</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回一个包含所有User的列表</td>
    </tr>
    <tr>
        <td rowspan="3">AdminMapper.getVip</td>
        <td>语法</td>
        <td>List&lt;User&gt; getVip;</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>无</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回一个包含所有是会员的User的列表</td>
    </tr>
    <tr>
        <td rowspan="3">AdminMapper.deleteUser</td>
        <td>语法</td>
        <td>int deleteUser(int userid);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>同样ID的user在数据库中存在</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>在数据库中删除一个同样id的User</td>
    </tr>
</table>
- 表24 coupon包数据层模块的接口规范

<table>
    <tr>
        <th colspan="3" align="center">提供的服务（供接口）</td>
    </tr>
    <tr>
        <td rowspan="3">CouponMapper.insertCoupon</td>
        <td>语法</td>
        <td>int insertCoupon(Coupon coupon);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>同样ID的coupon在数据库中不存在</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>在数据库中增加一个coupon记录</td>
    </tr>
    <tr>
        <td rowspan="3">CouponMapper.selectByHotelId</td>
        <td>语法</td>
        <td>List&lt;Coupon&gt; selectByHotelId(Integer hotelId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在数据库中存在同样ID的hotel</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>按hotelID进行查找返回所有Coupon的列表</td>
    </tr>
    <tr>
        <td rowspan="3">CouponMapper.selectAvailableCoupon</td>
        <td>语法</td>
        <td>List&lt;Coupon&gt; selectAvailableCoupon(Integer hotelId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在数据库中存在同样ID的hotel</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>按hotelID进行查找返回所有可用的Coupon的列表</td>
    </tr>
    <tr>
        <td rowspan="3">CouponMapper.getCouponList</td>
        <td>语法</td>
        <td>List&lt;Coupon&gt; getCouponList();</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>无</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>查找返回所有Coupon的列表</td>
    </tr>
    <tr>
        <td rowspan="3">CouponMapper.deleteCoupon</td>
        <td>语法</td>
        <td>int deleteCoupon(int couponid);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在数据库中存在同样ID的coupon</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>删除一个Coupon</td>
    </tr>
</table>
- 表25 hotel包数据层模块的接口规范

<table>
    <tr>
        <th colspan="3" align="center">提供的服务（供接口）</td>
    </tr>
    <tr>
        <td rowspan="3">HotelMapper.insertHotel</td>
        <td>语法</td>
        <td>int insertHotel(Hotel hotel);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>同样ID的hotel在数据库中不存在</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>在数据库中增加一个hotel记录</td>
    </tr>
    <tr>
        <td rowspan="3">HotelMapper.selectAllHotel</td>
        <td>语法</td>
        <td>List&lt;HotelVO&gt; selectAllHotel();</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>无</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回一个包含所有hotel的列表</td>
    </tr>
    <tr>
        <td rowspan="3">HotelMapper.selectManagerHotel</td>
        <td>语法</td>
        <td>List&lt;HotelVO&gt; selectManagerHotel(Integer managerId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>无</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>根据managerid选择返回一个包含相应hotel的列表</td>
    </tr>
	<tr>
        <td rowspan="3">HotelMapper.selectById</td>
        <td>语法</td>
        <td>HotelVO selectById(Integer id);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在数据库中存在同样ID的hotel</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>按ID进行查找返回相应的HotelVO结果</td>
    </tr>
    <tr>
        <td rowspan="3">HotelMapper.selectSearchedHotel</td>
        <td>语法</td>
        <td>List&lt;HotelVO&gt; selectSearchedHotel(String region, String address, String name, String star, Integer rate0, Integer rate1);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>无</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>按条件进行查找返回相应的hotel的列表</td>
    </tr>
    <tr>
        <td rowspan="3">HotelMapper.deleteHotel</td>
        <td>语法</td>
        <td>int deleteHotel(Integer hotelid);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在数据库中存在同样ID的hotel</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>删除一个Hotel</td>
    </tr>
    <tr>
        <td rowspan="3">HotelMapper.setHotelManager</td>
        <td>语法</td>
        <td>int setHotelManager(Integer hotelid, int managerid);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在数据库中存在同样ID的hotel和相同id的HotelManager</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>更新一个hotel记录的managerid字段</td>
    </tr>
    <tr>
        <td rowspan="3">HotelMapper.editHotel</td>
        <td>语法</td>
        <td>int editHotel(Integer id, String name, String address, String hotelStar, String description, String phoneNum);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在数据库中存在同样ID的hotel</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>更新一个hotel记录的多个字段</td>
    </tr>
    <tr>
        <td rowspan="3">HotelMapper.gerCur_rate</td>
        <td>语法</td>
        <td>double getCur_rate(Integer hotelid);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在数据库中存在同样ID的hotel</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回一个hotel记录的rate字段</td>
    </tr>
    <tr>
        <td rowspan="3">HotelMapper.updateRate</td>
        <td>语法</td>
        <td>int updateRate(Integer hotelid, double tar_rate);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在数据库中存在同样ID的hotel</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>更新一个hotel记录的rate字段</td>
    </tr>
    <tr>
        <td rowspan="3">HotelMapper.updateTotalMoney</td>
        <td>语法</td>
        <td>int updateTotalMoney(Integer hotelid, double money);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在数据库中存在同样ID的hotel</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>更新一个hotel记录的totalmoney字段</td>
    </tr>
	<tr>
        <td rowspan="3">RoomMapper.updateRoomInfo</td>
        <td>语法</td>
        <td>int updateRoomInfo(Integer hotelId, String roomType, Integer curNum);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在数据库中存在同样ID的hotel</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>更新一个room</td>
    </tr>
	<tr>
        <td rowspan="3">RoomMapper.insertRoom</td>
        <td>语法</td>
        <td>int insertRoom(HotelRoom hotelRoom);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>无</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>在数据库中增加一个room记录</td>
    </tr>
	<tr>
        <td rowspan="3">RoomMapper.selectRoomsByHotelId</td>
        <td>语法</td>
        <td>List&#60;HotelRoom&#62; selectRoomsByHotelId(Integer hotelId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在数据库中存在同样ID的hotel</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>按ID进行查找返回相应的room列表</td>
    </tr>
	<tr>
        <td rowspan="3">RoomMapper.getRoomCurNum</td>
        <td>语法</td>
        <td>int getRoomCurNum(Integer hotelId, String roomType);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在数据库中存在同样ID和roomType的hotel</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>按ID和roomType进行查找返回相应的数值</td>
    </tr>
    <tr>
        <td rowspan="3">RoomMapper.getMinPrice</td>
        <td>语法</td>
        <td>Integer getMinPrice(Integer hotelId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在数据库中存在同样ID的hotel</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>按hotelid查找所有room并返回price的最小值</td>
    </tr>
    <tr>
        <td rowspan="3">RoomMapper.editRoomPrice</td>
        <td>语法</td>
        <td>int editRoomPrice(Integer roomId, Integer val);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在数据库中存在同样ID的Room</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>更新一个Room的price字段</td>
    </tr>
    <tr>
        <td rowspan="3">RoomMapper.editRoomTotal</td>
        <td>语法</td>
        <td>int editRoomTotal(Integer roomId, Integer val);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在数据库中存在同样ID的Room</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>更新一个Room的total字段</td>
    </tr>
    <tr>
        <td rowspan="3">RoomMapper.editRoomCurNum</td>
        <td>语法</td>
        <td>int editRoomCurNum(Integer roomId, Integer val);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在数据库中存在同样ID的Room</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>更新一个Room的cur_num字段</td>
    </tr>
    <tr>
        <td rowspan="3">RoomMapper.deleteRoom</td>
        <td>语法</td>
        <td>int deleteRoom(Integer roomId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在数据库中存在同样ID的Room</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>删除一个Room</td>
    </tr>
</table>

- 表26 order包数据层模块的接口规范

<table>
    <tr>
        <th colspan="3" align="center">提供的服务（供接口）</td>
    </tr>
    <tr>
        <td rowspan="3">OrderMapper.addOrder</td>
        <td>语法</td>
        <td>int addOrder(Order order);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>同样ID的order在数据库中不存在</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>在数据库中增加一个order记录</td>
    </tr>
    <tr>
        <td rowspan="3">CouponMapper.getAllOrders</td>
        <td>语法</td>
        <td>List&lt;Order&gt; getAllOrders();</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>无</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>返回一个包含所有order的列表</td>
    </tr>
	<tr>
        <td rowspan="3">CouponMapper.getUserOrders</td>
        <td>语法</td>
        <td>List&lt;Order&gt; getUserOrders(int userid);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在数据库中存在同样ID的user</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>按userid进行查找返回相应的Order列表</td>
    </tr>
    <tr>
        <td rowspan="3">CouponMapper.getHotelOrders</td>
        <td>语法</td>
        <td>List&lt;Order&gt; getHotelOrders(int hotelId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在数据库中存在同样ID的hotel</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>按hotelid进行查找返回相应的Order列表</td>
    </tr>
    <tr>
        <td rowspan="3">CouponMapper.getUserHotelOrders</td>
        <td>语法</td>
        <td>List&lt;Order&gt; getUserHotelOrders(int userid, int hotelId);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在数据库中存在同样ID的user和hotel</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>按userid和hotelid进行查找返回相应的Order列表</td>
    </tr>
	<tr>
        <td rowspan="3">OrderMapper.annulOrder</td>
        <td>语法</td>
        <td>int annulOrder(int orderid);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在数据库中存在同样id的order</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>更新一个order的状态为“已撤销”</td>
    </tr>
    <tr>
        <td rowspan="3">OrderMapper.execOrder</td>
        <td>语法</td>
        <td>int execOrder(int orderid);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在数据库中存在同样id的order</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>更新一个order的状态为“已入住”</td>
    </tr>
    <tr>
        <td rowspan="3">OrderMapper.setOrderExcep</td>
        <td>语法</td>
        <td>int setOrderExcep(int orderid);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在数据库中存在同样id的order</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>更新一个order的状态为“异常”</td>
    </tr>
    <tr>
        <td rowspan="3">OrderMapper.checkOut</td>
        <td>语法</td>
        <td>int checkOut(int orderid);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在数据库中存在同样id的order</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>更新一个order的状态为“已退房”</td>
    </tr>
	<tr>
        <td rowspan="3">OrderMapper.getOrderById</td>
        <td>语法</td>
        <td>int getOrderById(int orderid);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>无</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>按ID进行查找返回相应的order结果</td>
    </tr>
    <tr>
        <td rowspan="3">OrderMapper.annualSubCredit</td>
        <td>语法</td>
        <td>int annualSubCredit(int orderid, double credit);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在数据库中存在同样id的order</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>更新order中userid对应的User的credit字段</td>
    </tr>
    <tr>
        <td rowspan="3">OrderMapper.updateOrderComment</td>
        <td>语法</td>
        <td>int updateOrderComment(int orderid, int star, String comment)</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在数据库中存在同样id的order</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>更新一个order的star和comment字段</td>
    </tr>
    <tr>
        <td rowspan="3">OrderMapper.getCommentNum</td>
        <td>语法</td>
        <td>int getCommentNum(int hotelid);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>无</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>获得相同hotelid的Order的数量</td>
    </tr>
</table>

- 表27 user包数据层模块的接口规范

<table>
    <tr>
        <th colspan="3" align="center">提供的服务（供接口）</td>
    </tr>
    <tr>
        <td rowspan="3">AccountMapper.createNewAccount</td>
        <td>语法</td>
        <td>int createNewAccount(User user);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>同样ID的user在数据库中不存在</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>在数据库中增加一个user记录</td>
    </tr>
    <tr>
        <td rowspan="3">AccountMapper.getAccountByEmail</td>
        <td>语法</td>
        <td>User getAccountByEmail(String email);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>无</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>按email进行查找返回相应的User结果</td>
    </tr>
	<tr>
        <td rowspan="3">AccountMapper.getAccountById</td>
        <td>语法</td>
        <td>User getAccountById(int id);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>无</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>按ID进行查找返回对应的User结果</td>
    </tr>
	<tr>
        <td rowspan="3">AccountMapper.updateAccount</td>
        <td>语法</td>
        <td>int updateAccount(int id, String password, String username, String phonenumber);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在数据库中存在同样ID的user</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>更新一个user的个人信息</td>
    </tr>
    <tr>
        <td rowspan="3">AccountMapper.setCredit</td>
        <td>语法</td>
        <td>int setCredit(int id, double credit);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在数据库中存在同样ID的User</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>更新一个User的credit字段</td>
    </tr>
    <tr>
        <td rowspan="3">AccountMapper.setLv</td>
        <td>语法</td>
        <td>int setCredit(int id, double lv);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在数据库中存在同样ID的User</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>更新一个User的lv字段</td>
    </tr>
    <tr>
        <td rowspan="3">AccountMapper.setTotalMoney</td>
        <td>语法</td>
        <td>int setTotalMoney(int id, double totalmoney);</td>
    </tr>
    <tr>
        <td>前置条件</td>
        <td>在数据库中存在同样ID的User</td>
    </tr>
    <tr>
        <td>后置条件</td>
        <td>更新一个User的totalmoney字段</td>
    </tr>
</table>

## 7 信息视角

### 7.1 数据持久化对象

系统的PO类就是对应的相关的实体类，在此只做简单的介绍。

- User类包含用户的ID、电子邮件地址、密码、用户名、电话号码、信用值、用户类型、用户总消费额、用户头像属性。 
- Order类包含订单的ID、用户名、酒店ID、酒店名、入住日期、退房日期、房间类型、房间号、人数、是否有儿童、创建日期、价格、客户名、手机号码、订单状态、评分、评价、会员等级属性。
- Hotel类包含酒店的ID、酒店名、地址、商圈、酒店星级、评分、描述、电话号码、酒店管理员id属性。
- HotelRoom类包含酒店房间的ID、房间类型、酒店ID、价格、当前剩余可预订房间数、各类型房间总数属性。
- Coupon类包含优惠券的ID、描述、酒店ID、类型、名称、使用门槛、折扣、优惠金额、可用时间、失效时间、状态属性。

持久化用户对象User的定义如代码块1所示。

- 代码块1 持久化用户对象User的定义

```java
public class User {
    
    private Integer id;
    private String email;
    private String password;
    private String userName;
    private String phoneNumber;
    private double credit;
    private UserType userType;
    private Integer lv;
    private double totalmoney;
    private String avatarurl;


    public Integer getId() {
        return id;
    }

    public void setId(Integer id) {
        this.id = id;
    }

    public String getUserName() {
        return userName;
    }

    public void setUserName(String userName) {
        this.userName = userName;
    }

    public String getPhoneNumber() {
        return phoneNumber;
    }

    public void setPhoneNumber(String phoneNumber) {
        this.phoneNumber = phoneNumber;
    }

    public double getCredit() {
        return credit;
    }

    public void setCredit(double credit) {
        this.credit = credit;
    }

    public String getEmail() {
        return email;
    }

    public void setEmail(String email) {
        this.email = email;
    }

    public String getPassword() {
        return password;
    }

    public void setPassword(String password) {
        this.password = password;
    }

    public UserType getUserType() {
        return userType;
    }

    public void setUserType(UserType userType) {
        this.userType = userType;
    }

    public Integer getLv() {
        return lv;
    }

    public void setLv(Integer lv) {
        this.lv = lv;
    }

    public double getTotalmoney() {
        return totalmoney;
    }

    public void setTotalmoney(double totalmoney) {
        this.totalmoney = totalmoney;
    }

    public String getAvatarurl() {
        return avatarurl;
    }

    public void setAvatarurl(String avatarurl) {
        this.avatarurl = avatarurl;
    }
}
```

### 7.2 数据库表

数据库中包含Coupon表、Hotel表、OrderList表、Room表、User表。